<!DOCTYPE html>
<html>

<head>
    <title> Replication of Shams et al. </title>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-slider-response"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-slider-response"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.3"></script>
    <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
 <style> 
    .slider {font-size: 20px; font-weight: bold; color: black;}
  </style>
</head>

const subject_id = jsPsych.randomization.randomID(10);
const filename = `${subject_id}.csv`;

<body></body>
<script>
    /* initialize jsPsych */
    var jsPsych = initJsPsych({
        on_finish: function () {
            jsPsych.data.displayData();
        }
    });

     /* create timeline */
     var timeline = [];

     var images = ['img/file1.png']

/* preload images */
var preload = {
    type: jsPsychPreload,
    images: images
};
timeline.push(preload);

/* define welcome message trial */
var welcome = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: "Welcome to the experiment. Press any key to begin."
};
timeline.push(welcome);

/* define instructions trial */
var instructions = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
    <p> In today's task you will be shown images of football players. </p>
        <p>Please <strong> rate these players </strong> regarding their <strong> body size </strong> on the scale, taking no longer than <strong> three seconds </strong> to respond.</p>
        <p> On the next page you will see two examples of how the football players might look like. </p> 
        <div style='width: 700px;'>
        </div>
        <p>Press enter to proceed. </p>
  `,
    post_trial_gap: 500
};
timeline.push(instructions);

// after instructions, show examples of players
var player_example = { 
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `<img src="">`,
        labels: ["very husky", "neither husky nor slender", "very slender"],
        prompt: 
    "<p> Example of most slender player size with a label and example of huskiest player size. </p>"
}; 
timeline.push(player_example);

var after_example = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
    <p> The football players you just saw hopefully gave you a general idea of how slender and husky players look. </p> 
    <p> <strong> Your task on the following slides will be to rate the football players regarding their body size on a scale. </strong> </p>
    <p> There is no right or wrong. Rate as you perceive, and please be diligent and do your best, and do not use the slider randomly. </p>
    <p> A fixation cross will appear prior to the image presentation of the football players. Please try to keep your gaze at this fixation cross. </p>
    <p> Note: The football players will only be displayed very briefly </p> 
    `
}; 
timeline.push(after_example);
/*
/// NOTE: I AM UNSURE ABOUT WHETHER WE NEED PRACTICE TRIALS NOW THAT WE HAVE THE SAME PRE-TRIAL INSTRUCTIONS AS THE ORIGINAL STUDY
/*

/* load practice trial stimuli */
var practice_stimuli = [
    { stimulus: "___" },
    { stimulus: "___" },
    { stimulus: "___" },
    { stimulus: "___" },
];

/* define fixation */
var fixation = {
    type: jsPsychHtmlKeyboardResponse,
    choices: "NO_KEYS",
    stimulus: '<div style="font-size:60px;">+</div>',
    trial_duration: 800,
    data: {
        task: 'fixation'
    }
};

/* define stimuli fixation */ 
var practice_stimuli_page = { 
    type: jsPsychHtmlKeyboardResponse,
    choices: "NO_KEYS",
    stimulus: jsPsych.timelineVariable('practice_stimuli'), 
    trial_duration: 400
}

var practice_trials = {
        type: jsPsychHtmlSliderResponse,
        stimulus: " ",
        css_classes: ['slider'],
        response_ends_trial: true,
        slider_width: 750, // include slider response 
        data: {
            task: 'response'
        },
        labels: ["very husky", "neither husky nor slender", "very slender"],
        on_finish: function (data) {
            data.correct = true;
        }
    };


var practice_procedure = {
        timeline: [fixation, practice_stimuli_page, practice_trials],
        timeline_variables: practice_stimuli
    };

    timeline.push(practice_procedure);

     /* define post-practice instructions */
     var post_practice_instructions = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
        <p> You have now completed the practice trials <p>
        <p> We will now begin the <b> main trials <b><p> 
        <p> Please press any key to begin <p>
      `,
        post_trial_gap: 1000
    };
    timeline.push(post_practice_instructions);

/// MAIN TRIAL STUFF ///

    /* load stimuli */

    var list_1 = [
        { stimulus: "____", body_size: 0, jersey_number: "low" },
        { stimulus: "____", body_size: 0, jersey_number: "low" },
        { stimulus: "____", body_size: 0, jersey_number: "low" },
        { stimulus: "____", body_size: 0, jersey_number: "low" }, 
        { stimulus: "____", body_size: 0, jersey_number: "low" }, 
        { stimulus: "____", body_size: 0, jersey_number: "low" }
    ];
    var list_2 = [{ stimulus: "____"}];
    var list_3 = [{ stimulus: "____"}];
    var list_4 = [{ stimulus: "____"}];
    var list_5 = [{ stimulus: "____"}];
    var list_6 = [{ stimulus: "____"}];
    var list_7 = [{ stimulus: "____"}];
    var list_8 = [{ stimulus: "____"}];
    var list_9 = [{ stimulus: "____", correct_response: '_____' }];
    var list_10 = [{ stimulus: "____", correct_response: '_____' }];
    /* Define trial stimuli/create blocks */

var test_stimuli_page = {
    type: jsPsychHtmlKeyboardResponse,
    choices: "NO_KEYS",
    stimulus: jsPsych.timelineVariable('stimulus'), 
    trial_duration: function () { 
        return jsPsych.randomization.sampleWithoutReplacement([250, 400, 500, 750, 1000, 1250, 1500, 1750, 2000], 2)[0]; // adjust duration as needed
    }
}
    var block_A_stimuli = [...list_1, ...list_3, ...list_5, ...list_7, ...list_9];

    var block_B_stimuli = [...list_2, ...list_4, ...list_6, ...list_8, ...list_10];


    var test_trial = {
        type: jsPsychHtmlSliderResponse,
        stimulus: "",
        css_classes: ['slider'],
        slider_width: 750,
        labels: ["very husky", "neither husky nor slender", "very slender"],
        data: {
            body_size: ,
            jersey_number: ,
        },
        on_finish: function (data) {
            data.correct = true; // Assuming there's no correctness criteria for  trials
        }
    }

    var test_procedure_block_A = {
        timeline: [fixation, test_stimuli_page, test_trial],
        timeline_variables: block_A_stimuli,
        randomize_order: true
    };
    
    var test_procedure_block_B = {
        timeline: [fixation, test_stimuli_page, test_trial],
        timeline_variables: block_B_stimuli,
        randomize_order: true
    };

    var test_break = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
        <p> You have now completed the first block of trials. <p>
        <p> Feel free to take a short break if needed. <p> 
        <p> Press any key when you are ready to begin the second block. <p>
      `,
        post_trial_gap: 1000
    };

    var test_complete = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
        <p> Congrats! You have now completed the experiment. <p>
        <p> Thank you for participating! <p> 
        <p> Please wait for further instruction from your experimenter <p>
      `,
        post_trial_gap: 1000
    };

    var blocks = [test_procedure_block_A, test_procedure_block_B]; 

    var rnd_blocks = jsPsych.randomization.shuffle(blocks); 

    timeline.push(rnd_blocks[0], test_break, rnd_blocks[1], test_complete);


    //run experiment 
    jsPsych.run(timeline)


const save_data = {
    type: jsPsychPipe,
    action: "save",
    experiment_id: "desVih9f2BAf",
    filename: filename,
    data_string: ()=>jsPsych.data.get().csv()
};

</script>

</html>
